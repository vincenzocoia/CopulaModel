# check empirical normal score transform
library(CopulaModel)

for(n in seq(100,1000,100)) { cat(n," ",nscoreOpta(n),"\n") }
#100   -0.5766102 
#200   -0.5673076 
#300   -0.5627994 
#400   -0.559935 
#500   -0.5578796 
#600   -0.5562977 
#700   -0.5550235 
#800   -0.5539637 
#900   -0.5530609 
#1000   -0.5522775 

# check nscore for vectors and matrices
x=1:20
nscoreOpta(length(x))
print(nscore(x))
# [1] -1.95996398 -1.43953147 -1.15034938 -0.93458929 -0.75541503 -0.59776013
# [7] -0.45376219 -0.31863936 -0.18911843 -0.06270678  0.06270678  0.18911843
#[13]  0.31863936  0.45376219  0.59776013  0.75541503  0.93458929  1.15034938
#[19]  1.43953147  1.95996398

print(nscore(x,iopt=T))
# [1] -2.06080784 -1.47413428 -1.17107282 -0.94885656 -0.76576249 -0.60535717
# [7] -0.45923451 -0.32234699 -0.19127021 -0.06341258  0.06341258  0.19127021
#[13]  0.32234699  0.45923451  0.60535717  0.76576249  0.94885656  1.17107282
#[19]  1.47413428  2.06080784

print(nscore(cbind(x,rev(x))))
print(nscore(cbind(x,rev(x)),iopt=T))
